{% extends "main.html" %}
{% block title %}Artworks | DreamArtMachine{% endblock %}
{% block content %}
<h1><img src="{{ url_for('static', filename='icons/svg/light/number-circle-two-light.svg') }}" class="hero-step-icon" alt="Step 2: Artwork" />Artwork</h1>
<p class="page-description">Browse and analyze uploaded artworks.</p>

{% if artworks %}
<div class="artwork-grid">
  {% for art in artworks %}
  <article class="gallery-card" data-filename="{{ art.filename }}" data-aspect="{{ art.aspect|default('unknown') }}">
    <div class="card-thumb">
      {% if art.thumb_path %}
      <img class="card-img-top" src="{{ get_artwork_image_url('unanalysed', art.thumb_path) }}" alt="{{ art.filename }}">
      {% else %}
      <div class="card-img-top placeholder">No thumbnail</div>
      {% endif %}
    </div>

    <div class="card-body">
      <h3 class="card-title">{{ art.filename }}</h3>
      <p class="card-meta">SKU: {{ art.sku or 'â€”' }}<br>Uploaded: {{ art.upload_date }}</p>

      <div class="button-row">
        <button class="btn btn-primary btn-analyze" data-provider="openai">Analyze</button>

        {% if art.edit_url %}
          <a class="btn btn-secondary" href="{{ art.edit_url }}">Edit</a>
        {% endif %}
        {% if art.review_url %}
          <a class="btn btn-secondary" href="{{ art.review_url }}">Review</a>
        {% endif %}

        <form method="post" action="{{ url_for('home.delete_unanalysed_artwork', slug=art.slug) }}" onsubmit="return confirm('Delete this artwork and its files? This cannot be undone.');">
          <button type="submit" class="btn btn-danger">Delete</button>
        </form>
      </div>
    </div>

    <div class="card-overlay hidden"></div>
  </article>
  {% endfor %}
</div>
{% else %}
<p>No artworks uploaded yet.</p>
{% endif %}
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='js/artworks.js') }}"></script>
{% endblock %}
