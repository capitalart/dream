{% extends "main.html" %}
{% block title %}Edit Listing: {{ slug }}{% endblock %}
{% block content %}
<h1>Edit Listing: {{ slug }}</h1>
<p class="page-description">Update artwork details and regenerate mockups before finalising.</p>
<div class="main-content">
  <img src="{{ url_for('static', filename='finalised-artwork/' ~ slug ~ '/' ~ slug ~ '.jpg') }}" alt="{{ slug }}" class="review-main-img" style="max-width:400px;display:block;margin-bottom:1rem;">
  <form method="post" action="{{ url_for('finalise.finalise', slug=slug) }}">
    <label for="title-input">Title</label>
    <input type="text" id="title-input" name="title" value="{{ title }}" required>
    <label for="description-input">Description</label>
    <textarea id="description-input" name="description" rows="5" required>{{ description }}</textarea>
    <label for="primary-colour">Primary Colour</label>
    <select id="primary-colour" name="primary_colour" required>
      {% for colour in colours %}
      <option value="{{ colour }}" {% if colour == primary_colour %}selected{% endif %}>{{ colour }}</option>
      {% endfor %}
    </select>
    <label for="secondary-colour">Secondary Colour</label>
    <select id="secondary-colour" name="secondary_colour" required>
      {% for colour in colours %}
      <option value="{{ colour }}" {% if colour == secondary_colour %}selected{% endif %}>{{ colour }}</option>
      {% endfor %}
    </select>
    <div class="mockups">
      {% for i in range(1, 10) %}
      <img src="{{ url_for('static', filename='finalised-artwork/' ~ slug ~ '/' ~ slug ~ '-MU-' ~ '%02d'|format(i) ~ '.jpg') }}" alt="Mockup {{ i }}">
      {% endfor %}
    </div>
    <button type="submit" name="action" value="finalise" class="btn btn-primary">Finalise Listing</button>
    <button type="submit" name="action" value="regenerate" class="btn btn-secondary">Regenerate Mockups</button>
  </form>
</div>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='js/edit_listing.js') }}"></script>
{% endblock %}
